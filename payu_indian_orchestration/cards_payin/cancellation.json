[
  {
    "requestMapping": {
      "method": "POST",
      "url": {
        "mappings": [
          {
            "value": "https://test.payu.in/merchant/postservice?form=2",
            "required": true
          }
        ],
        "operations": [
          {
            "name": "LIST_VALUE_JOIN"
          }
        ]
      },
      "headers": {
        "mappings": [
          {
            "key": "accept",
            "value": "application/json",
            "required": true
          },
          {
            "key": "Content-Type",
            "value": "application/x-www-form-urlencoded",
            "required": true
          }
        ],
        "operations": [
          {
            "name": "KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      },
      "body": {
        "mappings": [
          {
            "key": "key",
            "value": "{{bankTransaction.usedAuthKey}}",
            "operations": [
              {
                "name": "SPLIT_STRING",
                "params": {
                  "delimiter": "##"
                }
              },
              {
                "name": "GET_ELEMENT_AT_INDEX",
                "params": {
                  "index": 0
                }
              }
            ],
            "required": true
          },
          {
            "key": "command",
            "value": "cancel_refund_transaction",
            "required": true
          },
          {
            "key": "var1",
            "value": "{{bankTransaction.paymentTransId}}",
            "required": true
          },
          {
            "key": "var2",
            "mappings": [
              {
                "value": "{{purchase.purchaseId}}"
              },
              {
                "value": "R"
              }
            ],
            "operations": [
              {
                "name": "LIST_VALUE_JOIN"
              }
            ],
            "required": true
          },
          {
            "key": "var3",
            "value": "{{purchase.fx_Amount}}",
            "required": true
          },
          {
            "key": "var5",
            "mappings": [
              {
                "value": "{{extraParams.baseUrl}}",
                "required": true
              },
              {
                "value": "/webhook/",
                "required": true
              },
              {
                "value": "{{purchase.bankname}}",
                "required": true
              },
              {
                "value": "/",
                "required": true
              }
            ],
            "operations": [
              {
                "name": "LIST_VALUE_JOIN"
              }
            ],
            "required": false
          },
          {
            "key": "hash",
            "mappings": [
              {
                "value": "{{bankTransaction.usedAuthKey}}",
                "operations": [
                  {
                    "name": "SPLIT_STRING",
                    "params": {
                      "delimiter": "##"
                    }
                  },
                  {
                    "name": "GET_ELEMENT_AT_INDEX",
                    "params": {
                      "index": 0
                    }
                  }
                ],
                "required": true
              },
              {
                "value": "|",
                "required": true
              },
              {
                "value": "cancel_refund_transaction",
                "required": true
              },
              {
                "value": "|",
                "required": true
              },
              {
                "value": "{{bankTransaction.paymentTransId}}",
                "required": true
              },
              {
                "value": "|",
                "required": true
              },
              {
                "value": "{{bankTransaction.usedAuthKey}}",
                "operations": [
                  {
                    "name": "SPLIT_STRING",
                    "params": {
                      "delimiter": "##"
                    }
                  },
                  {
                    "name": "GET_ELEMENT_AT_INDEX",
                    "params": {
                      "index": 1
                    }
                  }
                ],
                "required": true
              }
            ],
            "operations": [
              {
                "name": "LIST_VALUE_JOIN"
              },
              {
                "name": "COMPUTE_SHA_HASH",
                "params": {
                  "algorithm": "SHA512"
                }
              }
            ],
            "required": true
          }
        ],
        "operations": [
          {
            "name": "KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      }
    },
    "responseMapping": {
      "body": {
        "mappings": [
          {
            "key": "status",
            "value": "{{pspResponse0.status}}",
            "operations": [
              {
                "name": "VALUE_MAPPER",
                "params": {
                  "mappings": [
                    {
                      "from": 1,
                      "to": "refund_in_process"
                    },
                    {
                      "from": 0,
                      "to": "refund_failed"
                    }
                  ],
                  "defaultValue": "refund_failed"
                }
              }
            ]
          },
          {
            "key": "code",
            "value": "{{pspResponse0.status}}",
            "operations": [
              {
                "name": "VALUE_MAPPER",
                "params": {
                  "mappings": [
                    {
                      "from": 1,
                      "to": "success"
                    },
                    {
                      "from": 0,
                      "to": "fail"
                    }
                  ],
                  "defaultValue": "fail"
                }
              }
            ]
          },
          {
            "key": "message",
            "mappings": [
              {
                "value": "{{pspResponse0.error_code}}",
                "operations": [
                  {
                    "name": "VALUE_MAPPER",
                    "params": {
                      "mappings": [
                        {
                          "from": 102,
                          "to": "Refund request accepted / queued"
                        }
                      ],
                      "defaultValue": ""
                    }
                  }
                ]
              },
              {
                "value": "{{pspResponse0.msg}}"
              }
            ],
            "operations": [
              {
                "name": "GET_FIRST_NON_EMPTY_STRING"
              }
            ]
          },
          {
            "key": "refundTransId",
            "value": "{{pspResponse0.request_id}}"
          }
        ],
        "operations": [
          {
            "name": "KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      }
    }
  }
]