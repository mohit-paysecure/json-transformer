[
  {
    "requestMapping":{
      "method":"POST",
      "url":{
        "mappings":[
          {
            "value":"https://api-sandbox.coinflow.cash/api/tokenize",
            "required":true
          }
        ],
        "operations":[
          {
            "name":"LIST_VALUE_JOIN"
          }
        ]
      },
      "headers":{
        "mappings":[
          {
            "key":"Content-Type",
            "value":"application/json",
            "required":true
          },
          {
            "key":"Accept",
            "value":"application/json",
            "required":true
          },
          {
            "key":"Authorization",
            "mappings":[
              {
                "value":"{{bankTransaction.usedAuthKey}}",
                "required":true,
                "operations":[
                  {
                    "name":"SPLIT_STRING",
                    "params":{
                      "delimiter":"##"
                    }
                  },
                  {
                    "name":"GET_ELEMENT_AT_INDEX",
                    "params":{
                      "index":0
                    }
                  }
                ]
              }
            ],
            "operations":[
              {
                "name":"LIST_VALUE_JOIN"
              }
            ],
            "required":true
          },
          {
            "key":"tx-apikey",
            "mappings":[
              {
                "value":"{{bankTransaction.usedAuthKey}}",
                "required":true,
                "operations":[
                  {
                    "name":"SPLIT_STRING",
                    "params":{
                      "delimiter":"##"
                    }
                  },
                  {
                    "name":"GET_ELEMENT_AT_INDEX",
                    "params":{
                      "index":1
                    }
                  }
                ]
              }
            ],
            "operations":[
              {
                "name":"LIST_VALUE_JOIN"
              }
            ],
            "required":true
          },
          {
            "key":"tx-token-scheme",
            "mappings":[
              {
                "value":"{{bankTransaction.usedAuthKey}}",
                "required":true,
                "operations":[
                  {
                    "name":"SPLIT_STRING",
                    "params":{
                      "delimiter":"##"
                    }
                  },
                  {
                    "name":"GET_ELEMENT_AT_INDEX",
                    "params":{
                      "index":2
                    }
                  }
                ]
              }
            ],
            "operations":[
              {
                "name":"LIST_VALUE_JOIN"
              }
            ],
            "required":true
          },
          {
            "key":"tx-tokenex-id",
            "mappings":[
              {
                "value":"{{bankTransaction.usedAuthKey}}",
                "required":true,
                "operations":[
                  {
                    "name":"SPLIT_STRING",
                    "params":{
                      "delimiter":"##"
                    }
                  },
                  {
                    "name":"GET_ELEMENT_AT_INDEX",
                    "params":{
                      "index":0
                    }
                  }
                ]
              }
            ],
            "operations":[
              {
                "name":"LIST_VALUE_JOIN"
              }
            ],
            "required":true
          }
        ],
        "operations":[
          {
            "name":"KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      },
      "body":{
        "mappings":[
          {
            "key":"data",
            "value":"{{cardInfo.number}}",
            "required":true
          },
          {
            "key":"card_cvv2",
            "value":"{{cardInfo.cvc}}",
            "required":true
          }
        ],
        "operations":[
          {
            "name":"KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      }
    },
    "responseMapping":{
      "body":{
        "mappings":[
          {
            "key":"status",
            "value":"{{pspResponse0.success}}",
            "operations":[
              {
                "name":"VALUE_MAPPER",
                "params":{
                  "mappings":[
                    {
                      "from":"true",
                      "to":"payment_in_process"
                    },
                    {
                      "from":"false",
                      "to":"payment_failed"
                    }
                  ],
                  "defaultValue":"payment_in_process"
                }
              }
            ]
          },
          {
            "key":"code",
            "value":"{{pspResponse0.result}}",
            "operations":[
              {
                "name":"VALUE_MAPPER",
                "params":{
                  "mappings":[
                    {
                      "from":"true",
                      "to":"success"
                    },
                    {
                      "from":"false",
                      "to":"fail"
                    }
                  ],
                  "defaultValue":"success"
                }
              }
            ]
          },
          {
            "key":"message",
            "value":"{{pspResponse0.error}}"
          }
        ],
        "operations":[
          {
            "name":"KEY_VALUE_LIST_TO_OBJECT"
          }
        ]
      }
    }
  },
  {
  "requestMapping":{
    "method":"POST",
    "url":{
      "mappings":[
        {
          "value":"https://api-sandbox.coinflow.cash/api/auth/session-key",
          "required":true
        }
      ],
      "operations":[
        {
          "name":"LIST_VALUE_JOIN"
        }
      ]
    },
    "headers":{
      "mappings":[
        {
          "key":"Content-Type",
          "value":"application/json",
          "required":true
        },
        {
          "key":"Accept",
          "value":"application/json",
          "required":true
        },
        {
          "key":"Authorization",
          "mappings":[
            {
              "value":"{{bankTransaction.usedAuthKey}}",
              "required":true,
              "operations":[
                {
                  "name":"SPLIT_STRING",
                  "params":{
                    "delimiter":"##"
                  }
                },
                {
                  "name":"GET_ELEMENT_AT_INDEX",
                  "params":{
                    "index":0
                  }
                }
              ]
            }
          ],
          "operations":[
            {
              "name":"LIST_VALUE_JOIN"
            }
          ],
          "required":true
        },
        {
          "key":"x-coinflow-auth-user-id",
          "value": "{{purchase.client.email}}",
          "required":true
        }
      ],
      "operations":[
        {
          "name":"KEY_VALUE_LIST_TO_OBJECT"
        }
      ]
    },
    "body":{
      "mappings":[
      ]
    }
  },
  "responseMapping":{
    "body":{
      "mappings":[
        {
          "key":"status",
          "value":"{{pspResponse1.details}}",
          "operations":[
            {
              "name":"CONDITIONAL_VALUE_MAPPER",
              "params":{
                "path":"pspResponse1.details",
                "mappedValue": "payment_in_process",
                "defaultValue":"payment_failed"
              }
            }
          ]
        },
        {
          "key":"code",
          "value":"{{pspResponse1.details}}",
          "operations":[
            {
              "name":"CONDITIONAL_VALUE_MAPPER",
              "params":{
                "path":"pspResponse1.details",
                "mappedValue": "payment_in_process",
                "defaultValue":"payment_failed"
              }
            }
          ]
        },
        {
          "key":"message",
          "value":"{{pspResponse1.details}}"
        },
        {
          "key":"pspToken",
          "value":"{{pspResponse1.key}}"
        }
      ],
      "operations":[
        {
          "name":"KEY_VALUE_LIST_TO_OBJECT"
        }
      ]
    }
  }
}
]